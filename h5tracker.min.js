!function(e,n){function t(e){if(!e||"string"!=typeof e)return e;var n=p[e];return n?n:(n=e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(/[-_]+([a-z])/gi,function(e,n){return n.toUpperCase()}),p[e]=n,n)}function r(){function e(e,n){return i.push({event:e,fn:n}),o}function n(e,n){return i=i.filter(function(t){return!(t.event===e&&t.fn===n)}),o}function t(t,r){function i(){n(t,i),r.apply(o,arguments)}return e(t,i),o}function r(e){var n=[].slice.call(arguments,1);return i.filter(function(n){return n.event===e}).forEach(function(e){e.fn.apply(o,n)}),o}var o={},i=[];return o.on=e,o.off=n,o.once=t,o.emit=r,o}function o(e,n,r){var o=function(i,a){var c,u;if("function"==typeof i)return u=i["-jsets-params"],u||(u=[],String(i).replace(/\(\s*([^()]+?)\s*\)/,function(e,n){u=n.split(/\s*,\s*/)}),i["-jsets-params"]=u),o(u,i);if("string"==typeof i||"number"==typeof i)return i=r?t(i):i,"function"==typeof a?(a.call(e,n(i)),e):n(i);if("object"==typeof i){if(i instanceof Array)return"function"==typeof a?(c=[],i.forEach(function(e){c.push(n(r?t(e):e))}),a.apply(e,c),e):(c={},i.forEach(function(e){c[e]=n(r?t(e):e)}),c);var f;if("function"==typeof a){c=[];for(f in i)c.push(n(r?t(f):f)||i[f]);return e}c={};for(f in i)c[f]=n(r?t(f):f)||i[f];return c}};return o}function i(e,n,t){function r(){if(n[l]!==p&&(f=null),!f)try{f=JSON.parse(n[e]||"[]")}catch(t){f=[]}}function o(){n[l]=d(),n[e]=JSON.stringify(f)}function i(e){r();var n=d(),i=Date.now();return f.push({id:n,birthday:i,expires:t,data:e}),o(),n}function a(){return r(),f.slice()}function c(){r();var e=0,n=Date.now();if(null!==v){if(!(n>v))return e;v=null}return f=f.filter(function(t){var r=t.birthday+1e3*t.expires;return n>r?(e++,!1):(v=null!==v?Math.min(v,r):r,!0)}),o(),e}function u(e){r(),f=f.filter(function(n){return e===n.id?(n.birthday+n.expires===v&&(v=null),!1):!0}),o()}n=n||localStorage,t=t||864e3;var f,s={},l=e+"_ts",p=null,v=null;return s.push=i,s.toArray=a,s.clean=c,s.remove=u,s}function a(n){function t(e){return f.push(e)}function r(e){var n=[];return Object.keys(e).forEach(function(t){null!==e[t]&&n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]))}),n.join("&")}function o(e,n,t){u.push({accept:n,acceptStyle:t,query:r(e)});a()}function a(){f.clean(),u.clean();var n=u.toArray().pop();if(n){var t=e.createElement("img");t.onload=function(){u.remove(n.id),delete c[n.id],setTimeout(function(){a()},1e3)};var r,o=n.data.accept.match(/^([^?]+)(?:\?(.*))?$/),i=o[0],s=o[1];r="path"===n.data.acceptStyle?i+(/\/$/.test(i)?"":"/")+n.data.query.replace(/[&=]/g,"/")+(s?"?"+s:""):i+"?"+n.data.query+(s?"&"+s:""),t.src=r,c[n.id]=t}}var c={},u=i(n+"_send"),f=i(n+"_log");return c.log=t,c.send=o,c.scan=a,c}function c(e,n,r){return function(o,i){if("string"==typeof o||"number"==typeof o)n(r?t(o):o,i);else if("object"==typeof o)if(o instanceof Array)o.forEach(function(e,t){n(t,e)});else for(var a in o)n(r?t(a):a,o[a]);return e}}function u(e){function n(e){if(!f)return void d.push({name:"send",data:e});if(!p.accept)return void console.error("options.accept is undefined.");var n={};if(p.data&&Object.keys(p.data).forEach(function(e){n[e]=p.data[e]}),Object.keys(l).forEach(function(e){n[e]=l[e]}),Object.keys(e).forEach(function(t){n[t]=e[t]}),p.event){var t=p.event.send;"function"==typeof t&&t.call(u,n)}u.emit("send",n),s.send(n,p.accept,p.acceptStyle)}function t(e){if(!f)return void d.push({name:"log",data:e});if("string"==typeof e&&(e={message:e,level:"debug"}),!e.level)return void console.error("log level is undefined.");var n={};if(Object.keys(e).forEach(function(t){n[t]=e[t]}),p.event){var t=p.event.log;"function"==typeof t&&t.call(u,n)}u.emit("log",n),s.log(n)}function i(e){return f?void console.error("Cannot duplicate create tracker."):e?(f=!0,p=e,d.forEach(function(e){u[e.name](e.data)}),void(d=null)):void console.error('Parameter "opts" cannot be empty.')}var u=r();u.name=e;var f,s=a(e),l={};u.set=c(u,function(e,n){l[e]=n},!0),u.get=o(u,function(e){return l[e]},!0);var p,d=[];return u.send=n,u.log=t,["debug","info","warn","error","fatal"].forEach(function(e){u[e]=function(n){t({level:e,message:n})}}),u.create=i,u}function f(e){function n(){}function t(n){if("string"!=typeof n)return void console.error('Parameter "line" is not a string type.');var t=n.match(/^(?:([\w$_]+)\.)?(\w+)$/);if(!t)return void console.error('Parameter "line" is invalid format.');var r=t[1],i=t[2],a=[].slice.call(arguments,1);if(r){var c=y[r];if(c||(c=y[r]=u(e+"_"+r),c.set({user:o})),"function"==typeof c[i])return c[i].apply(c,a);console.error('Tracker method "%s" is invalid.',i)}else{if("function"==typeof m[i])return m[i].apply(m,a);console.error('App method "%s" is invalid.',i)}}console.log("createApp() appName: %s",e);var o=localStorage[v.userId];o||(o=localStorage[v.userId]=d());var c=u("main");c.set({user:o}),c.createEmitter=r,c.createStorage=a,c.createStorageList=i,c.createTracker=u,c.newGuid=d,c.createApp=f,y[c.name]=c;return c.config=n,c.cmd=t,c}var s=n.h5tObjectName||"h5t",l=n[s];if(!l||!l.defined){var p={},d=function(){var e=parseInt(36*Math.random());return function(){return Date.now().toString(36)+(e++%36).toString(36)+Math.random().toString(36).slice(2,4)}}(),v=function(){var e="h5t@";return{userId:e+"global/userId",scanTime:e+"global/scanTime",sessionId:e+"global/sessionId",sessionBirthday:e+"global/sessionBirthday",sessionLiveTime:e+"global/sessionLiveTime",storageList:e+"storageList/send/#{app}/#{tracker}",storageListTS:e+"storageList/send/ts/#{app}/#{tracker}"}}(),y={},m=f(s),g=function(){m.cmd.apply(m,arguments)};if(g.app=m,g.defined=!0,l){var h=[].concat(l.p||[],l.q||[]);l.p=l.q=null,g.p=g.q={push:function(e){g.apply(g,e)}},h.forEach(function(e){g.apply(g,e)})}n[s]=g}}(document,window);