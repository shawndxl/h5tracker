!function(n,e){function t(n){if(!n||"string"!=typeof n)return n;var e=d[n];return e?e:(e=n.indexOf("-")<0&&n.indexOf("_")<0?n:n.replace(/[-_]+([a-z])/gi,function(n,e){return e.toUpperCase()}),d[n]=e,e)}function r(){return Date.now().toString(36)+Math.random().toString(36).slice(2,5)}function o(){function n(n,e){return i.push({event:n,fn:e}),o}function e(n,e){return i=i.filter(function(t){return!(t.event===n&&t.fn===e)}),o}function t(t,r){function i(){e(t,i),r.apply(o,arguments)}return n(t,i),o}function r(n){var e=[].slice.call(arguments,1);return i.filter(function(e){return e.event===n}).forEach(function(n){n.fn.apply(o,e)}),o}var o={},i=[];return o.on=n,o.off=e,o.once=t,o.emit=r,o}function i(n,e,t){function o(){if(e[p]!==d&&(l=null),!l)try{l=JSON.parse(e[n]||"[]")}catch(t){l=[]}}function i(){e[p]=r(),e[n]=JSON.stringify(l)}function a(n){o();var e=r(),a=Date.now();return l.push({id:e,birthday:a,expires:t,data:n}),i(),e}function c(){return o(),l.slice()}function f(){o();var n=0,e=Date.now();if(null!==v){if(!(e>v))return n;v=null}return l=l.filter(function(t){var r=t.birthday+1e3*t.expires;return e>r?(n++,!1):(v=null!==v?Math.min(v,r):r,!0)}),i(),n}function u(n){o(),l=l.filter(function(e){return n===e.id?(e.birthday+e.expires===v&&(v=null),!1):!0}),i()}e=e||localStorage,t=t||864e3;var l,s={},p=n+"_ts",d=null,v=null;return s.push=a,s.toArray=c,s.clean=f,s.remove=u,s}function a(n,e,r){var o=function(i,a){var c,f;if("function"==typeof i)return f=i["-jsets-params"],f||(f=[],String(i).replace(/\(\s*([^()]+?)\s*\)/,function(n,e){f=e.split(/\s*,\s*/)}),i["-jsets-params"]=f),o(f,i);if("string"==typeof i||"number"==typeof i)return i=r?t(i):i,"function"==typeof a?(a.call(n,e(i)),n):e(i);if("object"==typeof i){if(i instanceof Array)return"function"==typeof a?(c=[],i.forEach(function(n){c.push(e(r?t(n):n))}),a.apply(n,c),n):(c={},i.forEach(function(n){c[n]=e(r?t(n):n)}),c);var u;if("function"==typeof a){c=[];for(u in i)c.push(e(r?t(u):u)||i[u]);return n}c={};for(u in i)c[u]=e(r?t(u):u)||i[u];return c}};return o}function c(n,e,r){return function(o,i){if("string"==typeof o||"number"==typeof o)e(r?t(o):o,i);else if("object"==typeof o)if(o instanceof Array)o.forEach(function(n,t){e(t,n)});else for(var a in o)e(r?t(a):a,o[a]);return n}}function f(e){function t(n){return u.push(n)}function r(n){var e=[];return Object.keys(n).forEach(function(t){null!==n[t]&&e.push(encodeURIComponent(t)+"="+encodeURIComponent(n[t]))}),e.join("&")}function o(n,e){f.push({accept:e,query:r(n)});a()}function a(){u.clean(),f.clean();var e=f.toArray().pop();if(e){var t=n.createElement("img");t.onload=function(){f.remove(e.id),delete c[e.id],setTimeout(function(){a()},1e3)};var r=e.data.accept;t.src=r+(r.indexOf("?")<0?"?":"&")+e.data.query,c[e.id]=t}}var c={},f=i(e+"_send"),u=i(e+"_log");return c.log=t,c.send=o,c.scan=a,c}function u(n){function e(n){if(!u)return void d.push({name:"send",data:n});var e={};p.data&&Object.keys(p.data).forEach(function(n){e[n]=p.data[n]}),Object.keys(s).forEach(function(n){e[n]=s[n]}),Object.keys(n).forEach(function(t){e[t]=n[t]}),i.emit("send",e),l.send(e,p.accept)}function t(n){return u?("string"==typeof n&&(n={message:n,level:"debug"}),n.level?(i.emit("log",n),void l.log(n)):void console.error("log level is undefined.")):void d.push({name:"log",data:n})}function r(n){return u?void console.error("h5tracker: is repeat created"):(u=!0,p=n||{},n.event&&Object.keys(n.event).forEach(function(e){var t=n.event[e];"function"==typeof t&&i.on(e,t)}),d.forEach(function(n){i[n.name](n.data)}),void(d=null))}var i=o();i.name=n;var u,l=f(n),s={};i.set=c(i,function(n,e){s[n]=e},!0),i.get=a(i,function(n){return s[n]},!0);var p,d=[];return i.send=e,i.log=t,["debug","info","warn","error","fatal"].forEach(function(n){i[n]=function(e){t({level:n,message:e})}}),i.create=r,i}function l(n){function e(){}function t(e){if("string"!=typeof e)return void console.error('Parameter "line" is not a string type.');var t=e.match(/^(?:([\w$_]+)\.)?(\w+)$/);if(!t)return void console.error('Parameter "line" is invalid format.');var r=t[1],o=t[2],i=[].slice.call(arguments,1);if(r){var a=v[r];if(a||(a=v[r]=u(n+"_"+r)),"function"==typeof a[o])return a[o].apply(a,i);console.error('Tracker method "%s" is invalid.',o)}else{if("function"==typeof y[o])return y[o].apply(y,i);console.error('App method "%s" is invalid.',o)}}console.log("createApp() appName: %s",n);var a=u("main");a.createEmitter=o,a.createStorage=f,a.createStorageList=i,a.createTracker=u,a.newGuid=r,a.createApp=l,v[a.name]=a;return a.config=e,a.cmd=t,a}var s=e.h5tObjectName||"h5t",p=e[s];if(!p||!p.defined){var d={},v={},y=l(s),m=function(){y.cmd.apply(y,arguments)};if(m.app=y,m.defined=!0,p){var h=[].concat(p.p||[],p.q||[]);p.p=p.q=null,m.p=m.q={push:function(n){m.apply(m,n)}},h.forEach(function(n){m.apply(m,n)})}e[s]=m}}(document,window);